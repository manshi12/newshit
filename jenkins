#!/usr/bin/env groovy
@Library(['global-vars@CCRRAID-111_Git_tagIssue', 'pipeline-toolbox@MAVEN-SONAR-DSP','common-vars'])

node('JFROG') {
    // Checkout code first
    checkout scm
    
    // Run Maven build explicitly
    sh 'mvn clean package -DskipTests'
    
    // Verify JAR creation
    sh '''
        echo "Checking target directory:"
        ls -la target/
        echo "Looking for JAR files:"
        find target/ -name "*.jar"
    '''
    
    // Then run your integration
    cintegrateCommonOnPrem ([
        trigram: 'RIS',
        iappli:'3609',
        mavenSettingsId: 'MAVEN_SETTINGS_XML_JFROG_RIS',
        credentialSonar: 'SONARQUBE_TOKEN_RIS',
        sonarJavaTool: 'openjdk-11',
        sonarMinimumCoverage: 0
    ])
}
